{"ast":null,"code":"import _defineProperty from\"/Users/cdot/Desktop/Road To React book projects/reactWithFirebase/react-firebase-authentication/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/cdot/Desktop/Road To React book projects/reactWithFirebase/react-firebase-authentication/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/cdot/Desktop/Road To React book projects/reactWithFirebase/react-firebase-authentication/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/cdot/Desktop/Road To React book projects/reactWithFirebase/react-firebase-authentication/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/cdot/Desktop/Road To React book projects/reactWithFirebase/react-firebase-authentication/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/cdot/Desktop/Road To React book projects/reactWithFirebase/react-firebase-authentication/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/cdot/Desktop/Road To React book projects/reactWithFirebase/react-firebase-authentication/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{Link,withRouter}from\"react-router-dom\";import{compose}from\"recompose\";import{withFirebase}from\"../Firebase\";import*as ROUTES from\"../../constants/routes\";import*as ROLES from\"../../constants/roles\";var SignUp=function SignUp(){return React.createElement(\"div\",null,React.createElement(\"h1\",null,\"Sign Up\"),React.createElement(SignUpForm,null));};var ERROR_CODE_ACCOUNT_EXISTS=\"auth/email-already-in-use\";var ERROR_MSG_ACCOUNT_EXISTS=\"\\nAn account with this E-Mail address already exists.\\nTry to login with this account instead. If you think the account is already used from one of the social logins, try\\nto sign-in with one of them. Afterward, associate your accounts on your personal account page.\\n\";var INITIAL_STATE={username:\"\",email:\"\",passwordOne:\"\",passwordTwo:\"\",isAdmin:false,error:null};var SignUpFormBase=/*#__PURE__*/function(_Component){_inherits(SignUpFormBase,_Component);function SignUpFormBase(props){var _this;_classCallCheck(this,SignUpFormBase);_this=_possibleConstructorReturn(this,_getPrototypeOf(SignUpFormBase).call(this,props));_this.onSubmit=function(event){var _this$state=_this.state,username=_this$state.username,email=_this$state.email,passwordOne=_this$state.passwordOne,isAdmin=_this$state.isAdmin;var roles={};if(isAdmin){roles[ROLES.ADMIN]=ROLES.ADMIN;}_this.props.firebase.doCreateUserWithEmailAndPassword(email,passwordOne).then(function(authUser){//create a user in firebase realtime database\nreturn _this.props.firebase.user(authUser.user.uid).set({username:username,email:email,roles:roles});}).then(function(){return _this.props.firebase.doSendEmailVerification();}).then(function(authUser){_this.setState(_objectSpread({},INITIAL_STATE));_this.props.history.push(ROUTES.HOME);}).catch(function(error){if(error.code===ERROR_CODE_ACCOUNT_EXISTS){error.message=ERROR_MSG_ACCOUNT_EXISTS;}});event.preventDefault();};_this.onChange=function(event){_this.setState(_defineProperty({},event.target.name,event.target.value));};_this.onChangeCheckbox=function(event){_this.setState(_defineProperty({},event.target.name,event.target.checked));};_this.state=_objectSpread({},INITIAL_STATE);return _this;}_createClass(SignUpFormBase,[{key:\"render\",value:function render(){var _this$state2=this.state,username=_this$state2.username,email=_this$state2.email,passwordOne=_this$state2.passwordOne,passwordTwo=_this$state2.passwordTwo,isAdmin=_this$state2.isAdmin,error=_this$state2.error;var isInvalid=passwordOne!==passwordTwo||passwordOne===\"\"||passwordTwo===\"\"||email===\"\"||username===\"\";return React.createElement(\"form\",{onSubmit:this.onSubmit},React.createElement(\"input\",{name:\"username\",value:username,onChange:this.onChange,type:\"text\",placeholder:\"Full Name\"}),React.createElement(\"input\",{name:\"email\",value:email,onChange:this.onChange,type:\"text\",placeholder:\"Email Address\"}),\" \",React.createElement(\"input\",{name:\"passwordOne\",value:passwordOne,onChange:this.onChange,type:\"password\",placeholder:\"Password\"}),\" \",React.createElement(\"input\",{name:\"passwordTwo\",value:passwordTwo,onChange:this.onChange,type:\"password\",placeholder:\"Confirm Password\"}),React.createElement(\"label\",null,\"Admin:\",React.createElement(\"input\",{name:\"isAdmin\",type:\"checkbox\",checked:isAdmin,onChange:this.onChangeCheckbox})),React.createElement(\"button\",{disabled:isInvalid,type:\"submit\"},\"Sign Up\"),error&&React.createElement(\"p\",null,error.message));}}]);return SignUpFormBase;}(Component);var SignUpLink=function SignUpLink(){return React.createElement(\"p\",null,\"Don't have an account? \",React.createElement(Link,{to:ROUTES.SIGN_UP},\"Sign Up\"));};var SignUpForm=compose(withRouter,withFirebase)(SignUpFormBase);export default SignUp;export{SignUpForm,SignUpLink};","map":{"version":3,"sources":["/Users/cdot/Desktop/Road To React book projects/reactWithFirebase/react-firebase-authentication/src/components/SignUp/index.js"],"names":["React","Component","Link","withRouter","compose","withFirebase","ROUTES","ROLES","SignUp","ERROR_CODE_ACCOUNT_EXISTS","ERROR_MSG_ACCOUNT_EXISTS","INITIAL_STATE","username","email","passwordOne","passwordTwo","isAdmin","error","SignUpFormBase","props","onSubmit","event","state","roles","ADMIN","firebase","doCreateUserWithEmailAndPassword","then","authUser","user","uid","set","doSendEmailVerification","setState","history","push","HOME","catch","code","message","preventDefault","onChange","target","name","value","onChangeCheckbox","checked","isInvalid","SignUpLink","SIGN_UP","SignUpForm"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { compose } from \"recompose\";\n\nimport { withFirebase } from \"../Firebase\";\nimport * as ROUTES from \"../../constants/routes\";\nimport * as ROLES from \"../../constants/roles\";\n\nconst SignUp = () => (\n  <div>\n    <h1>Sign Up</h1>\n    <SignUpForm />\n  </div>\n);\n\nconst ERROR_CODE_ACCOUNT_EXISTS = \"auth/email-already-in-use\";\nconst ERROR_MSG_ACCOUNT_EXISTS = `\nAn account with this E-Mail address already exists.\nTry to login with this account instead. If you think the account is already used from one of the social logins, try\nto sign-in with one of them. Afterward, associate your accounts on your personal account page.\n`;\n\nconst INITIAL_STATE = {\n  username: \"\",\n  email: \"\",\n  passwordOne: \"\",\n  passwordTwo: \"\",\n  isAdmin: false,\n  error: null\n};\n\nclass SignUpFormBase extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = { ...INITIAL_STATE };\n  }\n\n  onSubmit = event => {\n    const { username, email, passwordOne, isAdmin } = this.state;\n\n    const roles = {};\n\n    if (isAdmin) {\n      roles[ROLES.ADMIN] = ROLES.ADMIN;\n    }\n\n    this.props.firebase\n      .doCreateUserWithEmailAndPassword(email, passwordOne)\n      .then(authUser => {\n        //create a user in firebase realtime database\n        return this.props.firebase.user(authUser.user.uid).set({\n          username,\n          email,\n          roles\n        });\n      })\n      .then(() => {\n        return this.props.firebase.doSendEmailVerification();\n      })\n      .then(authUser => {\n        this.setState({ ...INITIAL_STATE });\n        this.props.history.push(ROUTES.HOME);\n      })\n      .catch(error => {\n        if (error.code === ERROR_CODE_ACCOUNT_EXISTS) {\n          error.message = ERROR_MSG_ACCOUNT_EXISTS;\n        }\n      });\n\n    event.preventDefault();\n  };\n\n  onChange = event => {\n    this.setState({ [event.target.name]: event.target.value });\n  };\n\n  onChangeCheckbox = event => {\n    this.setState({ [event.target.name]: event.target.checked });\n  };\n\n  render() {\n    const {\n      username,\n      email,\n      passwordOne,\n      passwordTwo,\n      isAdmin,\n      error\n    } = this.state;\n\n    const isInvalid =\n      passwordOne !== passwordTwo ||\n      passwordOne === \"\" ||\n      passwordTwo === \"\" ||\n      email === \"\" ||\n      username === \"\";\n\n    return (\n      <form onSubmit={this.onSubmit}>\n        <input\n          name=\"username\"\n          value={username}\n          onChange={this.onChange}\n          type=\"text\"\n          placeholder=\"Full Name\"\n        />\n        <input\n          name=\"email\"\n          value={email}\n          onChange={this.onChange}\n          type=\"text\"\n          placeholder=\"Email Address\"\n        />{\" \"}\n        <input\n          name=\"passwordOne\"\n          value={passwordOne}\n          onChange={this.onChange}\n          type=\"password\"\n          placeholder=\"Password\"\n        />{\" \"}\n        <input\n          name=\"passwordTwo\"\n          value={passwordTwo}\n          onChange={this.onChange}\n          type=\"password\"\n          placeholder=\"Confirm Password\"\n        />\n        <label>\n          Admin:\n          <input\n            name=\"isAdmin\"\n            type=\"checkbox\"\n            checked={isAdmin}\n            onChange={this.onChangeCheckbox}\n          />\n        </label>\n        <button disabled={isInvalid} type=\"submit\">\n          Sign Up\n        </button>\n        {error && <p>{error.message}</p>}\n      </form>\n    );\n  }\n}\n\nconst SignUpLink = () => (\n  <p>\n    Don't have an account? <Link to={ROUTES.SIGN_UP}>Sign Up</Link>\n  </p>\n);\n\nconst SignUpForm = compose(\n  withRouter,\n  withFirebase\n)(SignUpFormBase);\n\nexport default SignUp;\n\nexport { SignUpForm, SignUpLink };\n"]},"metadata":{},"sourceType":"module"}